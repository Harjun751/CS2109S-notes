<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="MarkBind 6.2.0">
    <meta name="viewport" content="width=device-width, initial-scale=1"><title>Adversarial Search | Week 3</title> <link rel="stylesheet" href="/CS2109s-notes/markbind/css/bootstrap.min.css"> <link rel="stylesheet" href="/CS2109s-notes/markbind/fontawesome/css/all.min.css"> <link rel="stylesheet" href="/CS2109s-notes/markbind/glyphicons/css/bootstrap-glyphicons.min.css"><link rel="stylesheet" href="/CS2109s-notes/markbind/css/codeblock-dark.min.css"><link rel="stylesheet" href="/CS2109s-notes/markbind/css/markbind.min.css"><link rel="stylesheet" href="/CS2109s-notes/plugins/markbind-plugin-anchors/markbind-plugin-anchors.css"><link rel="stylesheet" href="/CS2109s-notes/plugins/markbind-plugin-tree/markbind-plugin-tree.css">
    
  <link rel="stylesheet" href="/CS2109s-notes/stylesheets/main.css">
</head>
<script>
  const baseUrl = '/CS2109s-notes'
</script>
<body  data-bs-spy="scroll" data-bs-target="#mb-page-nav" data-bs-offset="100"  data-code-theme="dark">
<div id="app"><!--[--><header sticky><div data-v-26aac3dc><nav class="navbar navbar-expand-md d-print-none navbar-dark bg-dark" data-v-26aac3dc><div class="container-fluid" data-v-26aac3dc><div class="navbar-left" data-v-26aac3dc><!--[--><!--]--></div><div class="navbar-default" data-v-26aac3dc><ul class="navbar-nav me-auto mt-2 mt-lg-0" data-v-26aac3dc><!--[--><!--]--></ul></div><ul class="navbar-nav navbar-right" data-v-26aac3dc><!--[--><li><form class="navbar-form"><div style="position:relative;" class="dropdown" data-v-00e26d0a><!--[--><input value="" data-bs-toggle="dropdown" type="text" class="form-control" placeholder="Search" autocomplete="off" data-v-00e26d0a><div class="form-control placeholder-div-hidden" data-v-00e26d0a>Search</div><!--]--><ul class="dropdown-menu search-dropdown-menu dropdown-menu-hidden dropdown-menu-end" data-v-00e26d0a><!--[--><!--]--></ul></div></form></li><!--]--></ul></div></nav><div style="display:none;" class="lower-navbar-container" data-v-26aac3dc><!--[--><!----><!----><!--]--></div></div></header> <div id="flex-body"><nav id="site-nav" data-v-6b1b63d2><!--[--><div class="site-nav-top"><div class="fw-bold mb-2" style="font-size:1.25rem;">Contents</div></div> <div class="nav-component slim-scroll"><div class="site-nav-root"><!--[--><ul class="site-nav-list site-nav-list-root" data-v-6b1b63d2><!--[--><li><div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/CS2109s-notes/index.html">Home</a></div></li> <li><div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/CS2109s-notes/contents/week2.html">Search</a></div></li> <li><div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/CS2109s-notes/contents/week3.html">Adversarial Search</a></div></li> <li><div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/CS2109s-notes/contents/week4.html">Machine Learning &amp; Decision Trees</a></div></li> <li><div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/CS2109s-notes/contents/week5.html">Linear Regression</a></div></li> <li><div class="site-nav-default-list-item site-nav-list-item-0" onclick="handleSiteNavClick(this)"><a href="/CS2109s-notes/contents/week6.html">Logistic Regression</a></div></li><!--]--><!--v-if--></ul><!--]--></div></div><!--]--><!--v-if--></nav> <div id="content-wrapper"><h1 id="local-search">Local Search<a class="fa fa-anchor" href="#local-search" onclick="event.stopPropagation()"></a></h1> <p>Strategy: Traverse state space by considering only <strong>locally-reachable</strong> states</p> <ul><li>Start at a random position in a state space.</li> <li>Iteratively move from a state to another &quot;better&quot; neighbouring state</li> <li>The solution is the final state after a certain number of steps.</li></ul> <p>Typically, <strong>incomplete</strong> and **suboptimal</p> <p><strong>Any-time</strong> property: longer runtime, often better solution</p> <ul><li>Get a &quot;good enough&quot; solution</li></ul> <div class="card-container ms-4" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>Recall: Problem formulation</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <br> <h2 id="problem-formulation-in-local-search">Problem formulation in Local Search<a class="fa fa-anchor" href="#problem-formulation-in-local-search" onclick="event.stopPropagation()"></a></h2> <p>Problem formulation is slightly different:</p> <p>States: Represent different configurations or <strong>candidate solution</strong>. They may or may not map to an actual problem state, but are used to represent potential solution.</p> <p>Initial State: The starting configuration (candidate solution)</p> <p>Note how there are no action/transition properties in the formulation.</p> <div class="card-container" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>N-queens example</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <div class="card-container" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>Minimizing a function example</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <br> <p><strong>Question</strong>:</p> <div class="card question" data-v-a3c8a6ee><div class="card-header alert-light border-bottom border-light text-dark" data-v-a3c8a6ee><!--[--><p>In local search, the solution is the <strong>final state</strong> rather than the path taken to reach it. Can local search be used to <em>potentially</em> find a good solution for shortest path problems?</p><!--]--></div><div class="card-body" data-v-a3c8a6ee><!--[--> <p><a href="/CS2109s-notes/assets/quiz3.png" target="_self"><img src="/CS2109s-notes/assets/quiz3.png" alt class="img-fluid"></a></p> <!--[--><!-- Mcq (radio) option --><div class="form-control" data-v-936903a8><div class="row" data-v-936903a8><div class="col-auto p-0" data-v-936903a8><svg viewBox="0 0 100 100" class="radio-svg" data-v-936903a8><circle cx="50" cy="50" r="47" fill="none" stroke="black" stroke-width="4" data-v-936903a8></circle><circle style="display:none;" cx="50" cy="50" r="25" fill="dodgerblue" data-v-936903a8></circle></svg></div><div class="col content" data-v-936903a8><!--[-->
    Yes
    <!--]--></div><div class="col-1" data-v-936903a8><!----></div></div><!----></div><!--]--> <!--[--><!-- Mcq (radio) option --><div class="form-control" data-v-936903a8><div class="row" data-v-936903a8><div class="col-auto p-0" data-v-936903a8><svg viewBox="0 0 100 100" class="radio-svg" data-v-936903a8><circle cx="50" cy="50" r="47" fill="none" stroke="black" stroke-width="4" data-v-936903a8></circle><circle style="display:none;" cx="50" cy="50" r="25" fill="dodgerblue" data-v-936903a8></circle></svg></div><div class="col content" data-v-936903a8><!--[-->
    No
  <!--]--></div><div class="col-1" data-v-936903a8><!----></div></div><!----></div><!--]--> <!--[--><!-- Mcq (radio) option --><div class="form-control" data-v-936903a8><div class="row" data-v-936903a8><div class="col-auto p-0" data-v-936903a8><svg viewBox="0 0 100 100" class="radio-svg" data-v-936903a8><circle cx="50" cy="50" r="47" fill="none" stroke="black" stroke-width="4" data-v-936903a8></circle><circle style="display:none;" cx="50" cy="50" r="25" fill="dodgerblue" data-v-936903a8></circle></svg></div><div class="col content" data-v-936903a8><!--[-->
    Depends
  <!--]--></div><div class="col-1" data-v-936903a8><!----></div></div><!----></div><!--]--><!--]--><!-- Text Question textarea and answer --><!----><!----><!-- Hint --><!----></div><!-- This removes the footer for questions where both the hint and check button has been clicked --><div class="card-footer alert-light border-top border-light text-dark" data-v-a3c8a6ee><!----><div name="q-btn" class="float-end" data-v-a3c8a6ee><!----><button type="button" class="btn btn-primary q-btn ms-1" data-v-a3c8a6ee> Check </button><button style="display:none;" type="button" class="btn btn-primary q-btn ms-1" data-v-a3c8a6ee> Next </button><button style="display:none;" type="button" class="btn btn-info q-btn ms-1" data-v-a3c8a6ee> Show </button><button style="display:none;" type="button" class="btn btn-primary q-btn ms-1" data-v-a3c8a6ee> Retry </button></div></div></div> <h2 id="evaluation-functions">Evaluation Functions<a class="fa fa-anchor" href="#evaluation-functions" onclick="event.stopPropagation()"></a></h2> <p>An evaluation function is a mathematical function used to assess the <em>quality</em> of a state.</p> <p>The function takes in a state as an argument and produces a number.</p> <p><strong>Important</strong>: An evaluation function should only return values between <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mo separator="true">,</mo><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" v-pre>(negative terminal, positive terminal)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">mina</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">mina</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></eq>. That is, either terminal state should be <em>more</em> preferrable than any intermediate state.</p> <pre><code class="hljs"><span>value = eval(state)
</span></code></pre><p>This value can either be minimized or maximized.</p> <ul><li><em>n-queens</em> - number of &quot;safe&quot; queens, we want to maximize</li> <li>minimizing a function - minimize the function f(x) itself</li></ul> <p><small>Note: a minimization objective f(x) can be transformed into a maximization objective by defining a new objective f&#39;(x) = -f(x) and vice versa</small></p> <h2 id="hill-climbing-algorithm">Hill climbing algorithm<a class="fa fa-anchor" href="#hill-climbing-algorithm" onclick="event.stopPropagation()"></a></h2> <pre><code class="hljs python"><span>current_state = initial_state
</span><span><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
</span><span>  best_successor = a **highest-<span class="hljs-built_in">eval</span>** successor state of current_state
</span><span>  <span class="hljs-keyword">if</span> <span class="hljs-built_in">eval</span>(best_succcessor) &lt;= <span class="hljs-built_in">eval</span>(current_state):
</span><span>    <span class="hljs-keyword">return</span> current_state
</span><span>  current_state = best_successor
</span></code></pre><h2 id="state-space-landscape">State Space Landscape<a class="fa fa-anchor" href="#state-space-landscape" onclick="event.stopPropagation()"></a></h2> <p><a href="/CS2109s-notes/assets/globalmaximum.png" target="_self"><img src="/CS2109s-notes/assets/globalmaximum.png" alt class="img-fluid"></a></p> <ul><li><strong>Global Maximum</strong>: The overall highest point or solution across the entire state space that represents the <u>optimal solution</u></li> <li><strong>Local Maximum</strong>: A point in the state space higher than neighbours.</li> <li><strong>Shoulder</strong> - A region with a <strong>flat</strong> area, making it difficult for the algo to move past.</li></ul> <h1 id="adversarial-search">Adversarial Search<a class="fa fa-anchor" href="#adversarial-search" onclick="event.stopPropagation()"></a></h1> <h2 id="multi-agent-problems">Multi-agent problems<a class="fa fa-anchor" href="#multi-agent-problems" onclick="event.stopPropagation()"></a></h2> <p>A problem that involves multiple agents <u>interacting within an environment</u>, where each has it&#39;s own goal(s) and decision-making. Can be cooperative, competitive, mixed-motive.</p> <h3 id="competitive-multi-agent-problems">Competitive Multi-agent problems<a class="fa fa-anchor" href="#competitive-multi-agent-problems" onclick="event.stopPropagation()"></a></h3> <p>Agents have conflicting goals.</p> <p>Two-player zero-sum games, where one player&#39;s gain is another&#39;s loss.</p> <h3 id="turn-taking-games">Turn-taking games<a class="fa fa-anchor" href="#turn-taking-games" onclick="event.stopPropagation()"></a></h3> <p>Next state of environment depends <u>not only</u> on our action in the current turn, but also the other agents in the next turn, which are assumed to be <strong>strategic</strong></p> <br> <h2 id="designing-an-agent-for-competitive-multi-agent-problems">Designing an agent <small>for <strong>competitive</strong> multi-agent problems</small><a class="fa fa-anchor" href="#designing-an-agent-for-competitive-multi-agent-problems" onclick="event.stopPropagation()"></a></h2> <div class="card-container ms-4" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>Terminology</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <h3 id="game-tree">Game tree<a class="fa fa-anchor" href="#game-tree" onclick="event.stopPropagation()"></a></h3> <p>A game tree is a graphical representation of all possible states and moves in a game. Not necessarily a tree.
<a href="/CS2109s-notes/assets/gametree.png" target="_self"><img src="/CS2109s-notes/assets/gametree.png" alt class="img-fluid"></a></p> <ul><li><strong>Nodes</strong> indicate all possible game state.</li> <li><strong>Edges</strong> show legal moves or transitions between states</li></ul> <p>The <strong>outcome</strong> of the game is displayed beneath each terminal node (end state).</p> <h3 id="problem-formulation">Problem Formulation<a class="fa fa-anchor" href="#problem-formulation" onclick="event.stopPropagation()"></a></h3> <p>We now have extra properties in the formulation:</p> <ul><li><strong>Terminal States</strong>: States where the game ends, such as win/lose/draw states. Can be defined as a function.</li> <li><strong>Utility Function</strong>: Outputs the value of a state from the perspective of our agent.
<ul><li>Our agent (player A) wants to <u>maximize</u> the utility.</li> <li>In games such as Chess, outcome is win/loss/draw (+1/0/-1)</li> <li>In games such as Go with territory scoring, outcome for player A is some real number.</li> <li>The utility of non-terminal states is typically not known in advance and must be computed.</li></ul></li></ul> <div class="card-container" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>Example: Sticks</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <br> <h2 id="algorithm-for-adversarial-search-minimax">Algorithm for Adversarial Search: Minimax<a class="fa fa-anchor" href="#algorithm-for-adversarial-search-minimax" onclick="event.stopPropagation()"></a></h2> <p>Algorithm specifically for a <strong>two player zero-sum</strong> game</p> <p>Core assumption: all players play <u>optimally</u></p> <p>Expand function: <code class="hljs inline no-lang">expand(state)</code></p> <ul><li>For each action, compute: <code class="hljs inline no-lang">next_state = transition(state, action)</code></li> <li>Returns a set of (action, next_state) pairs</li></ul> <p>Terminal function: <code class="hljs inline no-lang">is_terminal(state)</code></p> <ul><li>Returns true/false</li></ul> <p>Utility function: <code class="hljs inline no-lang">utility(state)</code></p> <ul><li>Returns a score for the state based on Player A.</li></ul> <pre><code class="hljs python"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">minimax</span>(<span class="hljs-params">state</span>):</span>
</span><span>  (action, v) = max_value(state)
</span><span>  <span class="hljs-keyword">return</span> action
</span></code></pre><pre><code class="hljs python"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">max_value</span>(<span class="hljs-params">state</span>):</span>
</span><span>  <span class="hljs-keyword">if</span> is_terminal(state): <span class="hljs-keyword">return</span> utility(state)
</span><span>  v = neg_inf
</span><span>  <span class="hljs-keyword">for</span> next_state <span class="hljs-keyword">in</span> expand(state):
</span><span>    v = <span class="hljs-built_in">max</span>(v, minimum value <span class="hljs-keyword">for</span> player A <span class="hljs-keyword">in</span> the next_state)
</span><span>  <span class="hljs-keyword">return</span> v
</span></code></pre><p>As we can see, the max_value assumes that the opponent plays optimally by minimizing player A in the <code class="hljs inline no-lang">max_value</code> function.</p> <pre><code class="hljs python"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">min_value</span>(<span class="hljs-params">state</span>):</span>
</span><span>  <span class="hljs-keyword">if</span> (is_terminal(state)): <span class="hljs-keyword">return</span> utility(state)
</span><span>  v = pos_inf
</span><span>  <span class="hljs-keyword">for</span> next_state <span class="hljs-keyword">in</span> expand(state):
</span><span>    v = <span class="hljs-built_in">min</span>(v, max_value(next_state))
</span><span>  <span class="hljs-keyword">return</span> v
</span></code></pre><p><a href="/CS2109s-notes/assets/minimaxdemo.png" target="_self"><img src="/CS2109s-notes/assets/minimaxdemo.png" alt class="img-fluid"></a>
So what actually happens in this algo is a step-by-step recursive dive to maximize the minima of a potential branch.</p> <h3 id="analysis">Analysis<a class="fa fa-anchor" href="#analysis" onclick="event.stopPropagation()"></a></h3> <p><strong>Time complexity</strong>: Exponential w.r.t. to depth. <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>b</mi><mi>m</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" v-pre>O(b^m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></eq>, where b = branching factor &amp; m = max-depth</p> <p><strong>Space Complexity</strong>: Polynomial.</p> <p><strong>Complete</strong>: Yes, if tree is finite.</p> <p><strong>Optimal</strong>: Yes, against optimal opponent.</p> <h4 id="optimality">Optimality<a class="fa fa-anchor" href="#optimality" onclick="event.stopPropagation()"></a></h4> <p>Theorem: In any finite, two-player zero-sum game of <strong>perfect</strong> information, the minimax algorithm computes the optimal strategy for both players, guaranteeing the best achievable outcome for each, <u>assuming both play optimally</u></p> <p>Theorem: If Player A&#39;s opponent <strong>deviates</strong> from optimal play, then for any action taken by Player A, the <strong>utility</strong> obtained by Player A is never less than the utility they would obtain against an optimal opponent.</p> <h3 id="the-problem-with-minimax">The problem with Minimax<a class="fa fa-anchor" href="#the-problem-with-minimax" onclick="event.stopPropagation()"></a></h3> <p><strong>Minimax explores the entire game tree.</strong></p> <p>However, evaluating a node sometimes becomes unnecessary, as it won&#39;t alter the decision.</p> <p><a href="/CS2109s-notes/assets/minimaxproblem.png" target="_self"><img src="/CS2109s-notes/assets/minimaxproblem.png" alt class="img-fluid"></a></p> <h2 id="alpha-beta-pruning">Alpha-Beta Pruning<a class="fa fa-anchor" href="#alpha-beta-pruning" onclick="event.stopPropagation()"></a></h2> <p>A variant of minimax that seeks to decrease the number of nodes that are evaluated.</p> <p>Maintain the best outcomes so far for Player A and Player B:</p> <ul><li><u>Alpha</u> is the highest outcome for player A so far.</li> <li><u>Beta</u> is the lowest outcome for player A so far.</li></ul> <p>Prune unnecessary nodes.</p> <ul><li>At the turn of <u>Player B</u>, if an action leads to a worse outcome for player A, then the rest of the actions are irrelevant; the node will have <u>at most</u> that &quot;worst outcome&quot;</li> <li>At the turn of <u>Player A</u>, if an action leads to a better outcome for player A (higher than beta), then the rest of the actions are irrelevant; the node will have <u>at least</u> that outcome which player B is not interested in</li></ul> <div class="card-container" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>How to traverse alpha-beta tree</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <p><strong>Psuedocode</strong></p> <pre><code class="hljs python"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">alpha_beta_search</span>(<span class="hljs-params">state</span>):</span>
</span><span>  (action, v) = max_value(state, -inf (alpha), inf (beta))
</span><span>  <span class="hljs-keyword">return</span> action
</span></code></pre><pre><code class="hljs python"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">max_value</span>(<span class="hljs-params">state, alpha, beta</span>):</span>
</span><span>  <span class="hljs-keyword">if</span> (is_terminal(state)): <span class="hljs-keyword">return</span> utility(state)
</span><span>  v = -inf
</span><span>  <span class="hljs-keyword">for</span> next_state <span class="hljs-keyword">in</span> expand(state):
</span><span>    v = <span class="hljs-built_in">max</span>(v, min_value(next_staet, alpha, beta))
</span><span>    alpha = <span class="hljs-built_in">max</span>(alpha, v)
</span><span>    <span class="hljs-keyword">if</span> (v &gt;= beta): <span class="hljs-keyword">return</span> v
</span><span>  <span class="hljs-keyword">return</span> v
</span></code></pre><pre><code class="hljs python"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">min_value</span>(<span class="hljs-params">state, alpha, beta</span>):</span>
</span><span>  <span class="hljs-keyword">if</span> (is_terminal(state)): <span class="hljs-keyword">return</span> utility(state)
</span><span>  v = inf
</span><span>  <span class="hljs-keyword">for</span> next_state <span class="hljs-keyword">in</span> expand(state):
</span><span>    v = <span class="hljs-built_in">min</span>(v, max_value(next_state, alpha, beta))
</span><span>    beta = <span class="hljs-built_in">min</span>(beta, v)
</span><span>    <span class="hljs-keyword">if</span> (v &lt;= alpha): <span class="hljs-keyword">return</span> v
</span><span>  <span class="hljs-keyword">return</span> v
</span></code></pre><h3 id="alpha-beta-pruning-analysis">Alpha-Beta Pruning analysis<a class="fa fa-anchor" href="#alpha-beta-pruning-analysis" onclick="event.stopPropagation()"></a></h3> <p>Theorem: Alpha-beta pruning <u>does not</u> alter the minimax value, and the optimal move computed for the root node; it only reduces the number of nodes evaluated.</p> <p>Making full use of alpha-beta pruning requires <strong>meta-reasoning</strong>: reasoning about which computations to do first (e.g. which branch to expand to first?)</p> <p>Theorem: Good move ordering increases alpha-beta pruning effectiveness; with &quot;perfect ordering&quot;, its complexity is <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>b</mi><mfrac><mi>m</mi><mn>2</mn></mfrac></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" v-pre>O(b^{\frac{m}{2}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0971em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8471em;"><span style="top:-3.363em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6915em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></eq></p> <div class="card-container" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>Alpha-Beta in the real world</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <br> <h2 id="imperfect-decisions-by-using-cutoff-on-top-of-alpha-beta">Imperfect Decisions by Using Cutoff on top of Alpha-Beta<a class="fa fa-anchor" href="#imperfect-decisions-by-using-cutoff-on-top-of-alpha-beta" onclick="event.stopPropagation()"></a></h2> <p>Instead of evaluating full tree,</p> <ul><li>Cutoff strategy - halt search in middle &amp; estimate value using evaluation function.</li></ul> <p>Modification: simply start returning an eval function at cutoff:</p> <p><a href="/CS2109s-notes/assets/cutoff.png" target="_self"><img src="/CS2109s-notes/assets/cutoff.png" alt class="img-fluid"></a></p> <h3 id="evaluation-function">Evaluation Function<a class="fa fa-anchor" href="#evaluation-function" onclick="event.stopPropagation()"></a></h3> <p>Assigns score to a game state, indicating favourability to a player.</p> <ul><li>If terminal state, use <code class="hljs inline no-lang">utlility(state)</code></li> <li>If not, use a heuristic</li></ul> <p>Heuristic function is an estimate of utility</p> <ul><li>A heuristic should fall somewhere between the minimum and maximum utility for all states.</li> <li>Computation must not be too expensive</li> <li>In adversarial search, admissibility and consistency properties do not apply</li></ul> <h3 id="inventing-a-heuristic">Inventing a heuristic<a class="fa fa-anchor" href="#inventing-a-heuristic" onclick="event.stopPropagation()"></a></h3> <ul><li><strong>Relaxed game</strong> - in principle, but usually too costly
<ul><li>Chess, each peice can teleport/self-sacrifice</li></ul></li> <li><strong>Expert Knowledge</strong> <ul><li>Often use features like material count, mobility, safety</li></ul></li> <li><strong>Learn from data</strong> <ul><li>Heuristic function could be learned from labeled dataset.</li></ul></li></ul> <div class="card-container" data-v-4484e25a><div class="card expandable-card" data-v-4484e25a><div class="card-header header-toggle bg-light" data-v-4484e25a><div class="caret-wrapper" data-v-4484e25a><!----></div><div class="header-wrapper card-title bg-light" data-v-4484e25a><!--[--><!--[--><p>Sticks game with cutoff</p><!--]--><!--]--></div><div class="button-wrapper" data-v-4484e25a><!--[--><button type="button" class="collapse-button btn btn-outline-secondary" style="" data-v-4484e25a><span class="collapse-icon glyphicon glyphicon-menu-down" aria-hidden="true"></span></button><button style="" type="button" class="btn-outline-secondary close-button btn" data-v-4484e25a><span class="glyphicon glyphicon-remove" aria-hidden="true" data-v-4484e25a></span></button><button style="display:none;" type="button" class="btn-outline-secondary popup-button btn" data-v-4484e25a><span class="glyphicon glyphicon-new-window" aria-hidden="true" data-v-4484e25a></span></button><!--]--></div></div><div class="card-collapse" data-v-4484e25a><!----><hr style="display:none;" data-v-4484e25a></div><!----></div></div> <h3 id="optimality-2">Optimality<a class="fa fa-anchor" href="#optimality-2" onclick="event.stopPropagation()"></a></h3> <p>Theorem: In a finite, two-player, zero-sum game, the minimax algorithm with cutoff and an evaluation function returns a move that is <u>optimal</u> with respect to the evaluation function at the cutoff</p> <p>The move may be <u>suboptimal</u> with respect to the true minimax value</p></div> <nav id="page-nav" data-v-6b1b63d2><!--[--><div class="nav-component slim-scroll"><a class="navbar-brand page-nav-title" href="#">Topics</a> <nav id="mb-page-nav" class="nav nav-pills flex-column my-0 small no-flex-wrap" data-v-6b1b63d2><!--[--><a class="nav-link py-1" href="#local-search">Local Search‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#problem-formulation-in-local-search">Problem formulation in Local Search‎</a> <a class="nav-link py-1" href="#evaluation-functions">Evaluation Functions‎</a> <a class="nav-link py-1" href="#hill-climbing-algorithm">Hill climbing algorithm‎</a> <a class="nav-link py-1" href="#state-space-landscape">State Space Landscape‎</a></nav> <a class="nav-link py-1" href="#adversarial-search">Adversarial Search‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#multi-agent-problems">Multi-agent problems‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#competitive-multi-agent-problems">Competitive Multi-agent problems‎</a> <a class="nav-link py-1" href="#turn-taking-games">Turn-taking games‎</a></nav> <a class="nav-link py-1" href="#designing-an-agent-for-competitive-multi-agent-problems">Designing an agent for competitive multi-agent problems‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#game-tree">Game tree‎</a> <a class="nav-link py-1" href="#problem-formulation">Problem Formulation‎</a></nav> <a class="nav-link py-1" href="#algorithm-for-adversarial-search-minimax">Algorithm for Adversarial Search: Minimax‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#analysis">Analysis‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#optimality">Optimality‎</a></nav> <a class="nav-link py-1" href="#the-problem-with-minimax">The problem with Minimax‎</a></nav> <a class="nav-link py-1" href="#alpha-beta-pruning">Alpha-Beta Pruning‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#alpha-beta-pruning-analysis">Alpha-Beta Pruning analysis‎</a></nav> <a class="nav-link py-1" href="#imperfect-decisions-by-using-cutoff-on-top-of-alpha-beta">Imperfect Decisions by Using Cutoff on top of Alpha-Beta‎</a> <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap"><a class="nav-link py-1" href="#evaluation-function">Evaluation Function‎</a> <a class="nav-link py-1" href="#inventing-a-heuristic">Inventing a heuristic‎</a> <a class="nav-link py-1" href="#optimality-2">Optimality‎</a></nav></nav><!--]--><!--v-if--></nav></div><!--]--><!--v-if--></nav> <div class="scroll-top-button fa-lg d-print-none" style="display:none;bottom:2%;right:2%;position:fixed;" aria-hidden="true"><!--[--><i class="fas fa-arrow-circle-up"></i><!--]--></div></div> <footer><div class="text-center"><small>[Generated by <a href="https://markbind.org/">MarkBind 6.2.0</a>]</small></div></footer><!--]--></div>
</body><script src="/CS2109s-notes/markbind/js/bootstrap-utility.min.js"></script>
<script src="/CS2109s-notes/markbind/js/polyfill.min.js"></script>
<script src="/CS2109s-notes/markbind/js/vue.global.prod.min.js"></script>
<script src="/CS2109s-notes/markbind/js/markbind.min.js"></script>
<script src="week3.page-vue-render.js"></script>
<script>
  MarkBind.setupWithSearch()
</script>
</html>
